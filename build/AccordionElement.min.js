/**
 * MIT License
 * 
 * Copyright (c) 2024 ploiu
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
if(!customElements.get("accordion-element")){let o=0;globalThis.accordions=[];class n extends HTMLElement{#n;#r;#i;#o;#s;#t;#e;#h;#l;constructor({title:e,id:t,isOpen:i,group:s}={}){super(),this.#n=e??this.dataset.title??"",this.#r=t??this.dataset.id??o++,this.#i=i??this.dataset.isOpen??!1,this.#o=s??this.dataset.group??"",globalThis.accordions.push(this),this.#e=null}#p(){let e=this.querySelector("div.ploiu-accordion-title");if(e)return e.addEventListener("click",()=>this.toggle()),e;{let t=document.createElement("div");return t.classList.add("ploiu-accordion-title"),t.innerText=this.#n,t.addEventListener("click",()=>this.toggle()),t}}#u(){let e=this.querySelector("div.ploiu-accordion-body");if(e)return e;{let t=document.createElement("div");t.classList.add("ploiu-accordion-body");let i=[...this.childNodes].filter(s=>!s.classList?.contains("ploiu-accordion-title"));for(let s of i){let r=s;t.appendChild(r.cloneNode(!0)),r.remove()}return t}}#c(){let e=[],t=this;for(;t?.parentNode;)e.push(t.parentNode),t=t.parentNode;return e=e.filter(i=>i?.tagName==="ACCORDION-ELEMENT"),e.length>0?e[0]:null}#f(){let e=[],t=this.#e;for(;t;)e.push(t),t=t.#c();return e}#d(e){this.#e?.isOpen&&(this.#e.bodyElement.style.height=Number.parseFloat(this.#e.bodyElement.style.height.replace(/px/,""))+e+"px",this.#e.#d(e))}#a(e){this.#e?.isOpen&&(this.#e.bodyElement.style.height=this.#e.bodyElement.clientHeight-e+"px",this.#e.#a(e))}get accordionId(){return this.#r}get group(){return this.#o}set group(e){this.#o=e,this.dataset.group=e}get title(){return this.#n}set title(e){if(typeof e=="string")this.#n=e,this.isConnected&&(this.#s.innerText=e);else if(e instanceof Node){if(!this.isConnected)throw"Can't set an accordion element title to a node when it hasn't been appended to the document!";this.#n="",this.#s.innerText="",[...this.#s.children].forEach(t=>t.remove()),this.#s.appendChild(e)}}get isOpen(){return this.#i}get bodyElement(){return this.#t}set body(e){if(!this.isConnected)throw"Can't set an accordion element body when it hasn't been appended to the document!";Array.from(this.#t.children).forEach(t=>t?.remove()),this.#t.appendChild(e)}expand(){let e=this.#f();n.findAccordionsByGroup(this.#o).filter(t=>t!==this&&!e.includes(t)&&this.#e===t.#e).forEach(t=>t.collapse()),this.#i=!0,this.#t.style.height=`${this.#t.scrollHeight}px`,this.#d(this.#t.scrollHeight),this.classList.add("open")}collapse(){this.#i&&(this.#i=!1,this.#e&&this.#a(this.bodyElement.scrollHeight),this.#t.style.height="0",this.classList.remove("open"),Array.from(this.querySelectorAll("accordion-element")).forEach(e=>e.collapse()))}toggle(){this.#i?this.collapse():this.expand()}connectedCallback(){!this.#h&&this.isConnected&&(this.#s=this.#p(),this.#t=this.#u(),this.appendChild(this.#s),this.appendChild(this.#t),(this.dataset.open!==void 0||this.#i)&&this.expand(),this.#e=this.#c(),this.#e!==null?this.#l=this.#e.scrollHeight:this.#l=0,this.#h=!0)}static findAccordionById(e){try{return window.accordions.filter(t=>t.id===e)[0]}catch{return null}}static findAccordionsByGroup(e){return[...document.querySelectorAll("accordion-element")].filter(t=>{t.isConnected&&(t.group?.toLowerCase(),e.toLowerCase())})}}class h extends HTMLElement{connectedCallback(){this.isConnected&&(Array.from(this.querySelectorAll("accordion-element")).forEach(e=>e.group=`fan-${o}`),o++)}}customElements.define("accordion-element",n),customElements.define("accordion-fan",h),globalThis.AccordionElement=n}